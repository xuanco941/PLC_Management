@{
    Layout = "_Layout";
}
@using PLC_Management.Models.ActivityModel
<link rel="stylesheet" href="~/css/Record.css" />

<div class="row">
    <div class="col-12" style="margin-top:25px;">
        <h1 style="text-align: center;">
            Lịch sử hoạt động
        </h1>
    </div>

    <div class="col-12" style="margin-top:10px; margin-bottom:10px;">
        <div class="col-12" style="margin-bottom:10px;">
            <select>
                <option value="find_by_day">Lọc theo ngày</option>
            </select>
        </div>

        <form class="search col-12" method="get">
            <label for="tungay">Từ ngày </label>
            <input id="tungay" name="tungay" value=@ViewBag.tungay type="date" style="margin-right:40px;" />

            <label for="toingay">Tới ngày</label>
            <input id="toingay" value=@ViewBag.toingay name="toingay" type="date" style="margin-right:40px;" />

            <button type="submit" class="btn-primary btn">Lọc</button>
        </form>
    </div>




    <div class="col-12">

        <!--Table-->
        <table class="table table-primary " id="table">

            <!--Table head-->
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Hành động</th>
                    <th>Ngày</th>
                </tr>
            </thead>
            <!--Table head-->
            <!--Table body-->



            <tbody>
                @{
                    int i = 0;
                }
                @foreach (Activity activity in ViewBag.listActivities)
                {
                    int j = i + 1;
                    if (i % 2 == 0)
                    {
                        <tr class="table-info">
                            <th scope="row">@j</th>
                            <td>@activity.Name</td>
                            <td>@activity.Time</td>
                        </tr>

                    }
                    else
                    {
                        <tr>
                            <th scope="row">@j</th>
                            <td>@activity.Name</td>
                            <td>@activity.Time</td>
                        </tr>
                    }
                    i++;
                }

            </tbody>
            <!--Table body-->





        </table>
    </div>
</div>


<nav aria-label="...">
    <ul class="pagination justify-content-center">
        @for (int j = 1; j <= @ViewBag.countPage; j++)
        {
            string link = @ViewBag.host + j;
            <li class="page-item"><a class="page-link" href="./@link">@j</a></li>
        }
    </ul>
</nav>

<div class="bottomPlace"
     style="width:100%; display: flex; flex-direction: row; flex-wrap: wrap; justify-content: end; margin-bottom:30px;">
    <button class="btn-primary btn" id="btn-export">Xuất file excel</button>
</div>

<script src="./js/table2excel.js"></script>
<script>
    const table2excel = new Table2Excel();
    document.querySelector("#btn-export").addEventListener("click", () => {
        table2excel.export(document.querySelector("#table"));
    })
</script>
<script src="~/js/Activity.js"></script>